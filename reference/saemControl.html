<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Control Options for SAEM — saemControl • nlmixr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Control Options for SAEM — saemControl" />
<meta property="og:description" content="Control Options for SAEM" />
<meta property="og:image" content="/logo.png" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nlmixr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">Getting started</li>
    <li>
      <a href="../articles/running_nlmixr.html">Introduction to Running Nlmixr</a>
    </li>
    <li>
      <a href="../articles/multiple-endpoints.html">Using Multiple Endpoints in Nlmixr</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Going further</li>
    <li>
      <a href="../articles/modelPiping.html">Model Piping</a>
    </li>
    <li>
      <a href="../articles/broom.html">Sweeping models to tidy datasets (broom)</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../articles/xgxr-nlmixr-ggpmx.html">Integrated development with xgxr/nlmixr/ggPMX</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-chalkboard-teacher"></span>
     
    Example models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/addingCovariances.html">Phenobarbatol with correlations</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../articles/nimo.html">Nonlinear PK/PD -- Nimotuzumab</a>
    </li>
    <li>
      <a href="../articles/mavoglurant.html">PBPK -- Mavoglurant</a>
    </li>
    <li>
      <a href="../articles/wbc.html">PKPD -- Myelosuppression model</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/nlmixrdevelopment/nlmixr/raw/master/CheatSheet_nlmixr.pdf">
    <span class="fas fa-scroll fa-lg"></span>
     
    Cheat Sheet
  </a>
</li>
<li>
  <a href="https://doi.org/10.1002/psp4.12445">
    <span class="fas fa-life-ring"></span>
     
    Tutorial
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-file-code-o fa-lg"></span>
     
    Functions
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nlmixrdevelopment/nlmixr">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/nlmixrdevelopment/nlmixr/releases">
    <span class="fas fa-download"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Control Options for SAEM</h1>
    <small class="dont-index">Source: <a href='https://github.com/nlmixrdevelopment/nlmixr/blob/master/R/nlmixr.R'><code>R/nlmixr.R</code></a></small>
    <div class="hidden name"><code>saemControl.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Control Options for SAEM</p>
    </div>

    <pre class="usage"><span class='fu'>saemControl</span><span class='op'>(</span>
  seed <span class='op'>=</span> <span class='fl'>99</span>,
  nBurn <span class='op'>=</span> <span class='fl'>200</span>,
  nEm <span class='op'>=</span> <span class='fl'>300</span>,
  nmc <span class='op'>=</span> <span class='fl'>3</span>,
  nu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
  atol <span class='op'>=</span> <span class='fl'>1e-06</span>,
  rtol <span class='op'>=</span> <span class='fl'>1e-04</span>,
  method <span class='op'>=</span> <span class='st'>"liblsoda"</span>,
  transitAbs <span class='op'>=</span> <span class='cn'>FALSE</span>,
  print <span class='op'>=</span> <span class='fl'>1</span>,
  trace <span class='op'>=</span> <span class='fl'>0</span>,
  covMethod <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"linFim"</span>, <span class='st'>"fim"</span>, <span class='st'>"r,s"</span>, <span class='st'>"r"</span>, <span class='st'>"s"</span>, <span class='st'>""</span><span class='op'>)</span>,
  calcTables <span class='op'>=</span> <span class='cn'>TRUE</span>,
  logLik <span class='op'>=</span> <span class='cn'>FALSE</span>,
  nnodes.gq <span class='op'>=</span> <span class='fl'>3</span>,
  nsd.gq <span class='op'>=</span> <span class='fl'>1.6</span>,
  optExpression <span class='op'>=</span> <span class='cn'>FALSE</span>,
  maxsteps <span class='op'>=</span> <span class='fl'>100000L</span>,
  adjObf <span class='op'>=</span> <span class='cn'>TRUE</span>,
  sum.prod <span class='op'>=</span> <span class='cn'>FALSE</span>,
  addProp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"combined2"</span>, <span class='st'>"combined1"</span><span class='op'>)</span>,
  singleOde <span class='op'>=</span> <span class='cn'>TRUE</span>,
  tol <span class='op'>=</span> <span class='fl'>1e-06</span>,
  itmax <span class='op'>=</span> <span class='fl'>30</span>,
  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"nelder-mead"</span>, <span class='st'>"newuoa"</span><span class='op'>)</span>,
  powRange <span class='op'>=</span> <span class='fl'>10</span>,
  lambdaRange <span class='op'>=</span> <span class='fl'>3</span>,
  loadSymengine <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>seed</th>
      <td><p>Random Seed for SAEM step.  (Needs to be set for
reproducibility.)  By default this is 99.</p></td>
    </tr>
    <tr>
      <th>nBurn</th>
      <td><p>Number of iterations in the Stochastic Approximation
(SA), or burn-in step. This is equivalent to Monolix's <code>K_0</code> or <code>K_b</code>.</p></td>
    </tr>
    <tr>
      <th>nEm</th>
      <td><p>Number of iterations in the Expectation-Maximization
(EM) Step. This is equivalent to Monolix's <code>K_1</code>.</p></td>
    </tr>
    <tr>
      <th>nmc</th>
      <td><p>Number of Markov Chains. By default this is 3.  When
you increase the number of chains the numerical integration by
MC method will be more accurate at the cost of more
computation.  In Monolix this is equivalent to <code>L</code></p></td>
    </tr>
    <tr>
      <th>nu</th>
      <td><p>This is a vector of 3 integers. They represent the
    numbers of transitions of the three different kernels used in
    the Hasting-Metropolis algorithm.  The default value is <code><a href='https://rdrr.io/r/base/c.html'>c(2,2,2)</a></code>,
    representing 40 for each transition initially (each value is
    multiplied by 20).</p>
<p>The first value represents the initial number of multi-variate
    Gibbs samples are taken from a normal distribution.</p>
<p>The second value represents the number of uni-variate, or multi-
    dimensional random walk Gibbs samples are taken.</p>
<p>The third value represents the number of bootstrap/reshuffling or
    uni-dimensional random samples are taken.</p></td>
    </tr>
    <tr>
      <th>atol</th>
      <td><p>a numeric absolute tolerance (1e-8 by default) used
by the ODE solver to determine if a good solution has been
achieved;  This is also used in the solved linear model to check
if prior doses do not add anything to the solution.</p></td>
    </tr>
    <tr>
      <th>rtol</th>
      <td><p>a numeric relative tolerance (<code>1e-6</code> by default) used
by the ODE solver to determine if a good solution has been
achieved. This is also used in the solved linear model to check
if prior doses do not add anything to the solution.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The method for solving ODEs.  Currently this supports:</p><ul>
<li><p><code>"liblsoda"</code> thread safe lsoda.  This supports parallel
thread-based solving, and ignores user Jacobian specification.</p></li>
<li><p><code>"lsoda"</code> -- LSODA solver.  Does not support parallel thread-based
solving, but allows user Jacobian specification.</p></li>
<li><p><code>"dop853"</code> -- DOP853 solver.  Does not support parallel thread-based
solving nor user Jacobain specification</p></li>
<li><p><code>"indLin"</code> -- Solving through inductive linearization.  The RxODE dll
must be setup specially to use this solving routine.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>transitAbs</th>
      <td><p>boolean indicating if this is a transit
compartment absorption</p></td>
    </tr>
    <tr>
      <th>print</th>
      <td><p>The number it iterations that are completed before
anything is printed to the console.  By default, this is 1.</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>An integer indicating if you want to trace(1) the
SAEM algorithm process.  Useful for debugging, but not for
typical fitting.</p></td>
    </tr>
    <tr>
      <th>covMethod</th>
      <td><p>Method for calculating covariance.  In this
    discussion, R is the Hessian matrix of the objective
    function. The S matrix is the sum of each individual's
    gradient cross-product (evaluated at the individual empirical
    Bayes estimates).</p>
<p>"<code>linFim</code>" Use the Linearized Fisher Information Matrix to calculate the covariance.</p>
<p>"<code>fim</code>" Use the SAEM-calculated Fisher Information Matrix to calculate the covariance.</p>
<p>"<code>r,s</code>" Uses the sandwich matrix to calculate the covariance, that is: \(R^-1 \times S \times R^-1\)</p>
<p>"<code>r</code>" Uses the Hessian matrix to calculate the covariance as \(2\times R^-1\)</p>
<p>"<code>s</code>" Uses the crossproduct matrix to calculate the covariance as \(4\times S^-1\)</p>
<p>"" Does not calculate the covariance step.</p></td>
    </tr>
    <tr>
      <th>calcTables</th>
      <td><p>This boolean is to determine if the foceiFit
will calculate tables. By default this is <code>TRUE</code></p></td>
    </tr>
    <tr>
      <th>logLik</th>
      <td><p>boolean indicating that log-likelihood should be
calculate by Gaussian quadrature.</p></td>
    </tr>
    <tr>
      <th>nnodes.gq</th>
      <td><p>number of nodes to use for the Gaussian
quadrature when computing the likelihood with this method
(defaults to 1, equivalent to the Laplaclian likelihood)</p></td>
    </tr>
    <tr>
      <th>nsd.gq</th>
      <td><p>span (in SD) over which to integrate when computing
the likelihood by Gaussian quadrature. Defaults to 3 (eg 3
times the SD)</p></td>
    </tr>
    <tr>
      <th>optExpression</th>
      <td><p>Optimize the RxODE expression to speed up
calculation. By default this is turned on.</p></td>
    </tr>
    <tr>
      <th>maxsteps</th>
      <td><p>maximum number of (internally defined) steps allowed
during one call to the solver. (5000 by default)</p></td>
    </tr>
    <tr>
      <th>adjObf</th>
      <td><p>is a boolean to indicate if the objective function
should be adjusted to be closer to NONMEM's default objective
function.  By default this is <code>TRUE</code></p></td>
    </tr>
    <tr>
      <th>sum.prod</th>
      <td><p>Take the RxODE model and use more precise products/sums.
Increases solving accuracy and solving time.</p></td>
    </tr>
    <tr>
      <th>addProp</th>
      <td><p>one of "combined1" and "combined2"; These are the
two forms of additive+proportional errors supported by
monolix/nonmem:</p>
<p>combined1: transform(y)=transform(f)+(a+b*f^c)*eps</p>
<p>combined2: transform(y)=transform(f)+(a^2+b^2*f^(2c))*eps</p></td>
    </tr>
    <tr>
      <th>singleOde</th>
      <td><p>This option allows a single ode model to include
the PK parameter information instead of splitting it into a
function and a RxODE model</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>This is the tolerance for the regression models used
for complex residual errors (ie add+prop etc)</p></td>
    </tr>
    <tr>
      <th>itmax</th>
      <td><p>This is the maximum number of iterations for the
regression models used for complex residual errors.  The number
of iterations is itmax*number of parameters</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>indicates the type of optimization for the residuals; Can be one of c("nelder-mead", "newuoa")</p></td>
    </tr>
    <tr>
      <th>powRange</th>
      <td><p>This indicates the range that powers can take for residual errors;  By default this is 10 indicating the range is c(1/10, 10) or c(0.1,10)</p></td>
    </tr>
    <tr>
      <th>lambdaRange</th>
      <td><p>This indicates the range that Box-Cox and Yeo-Johnson parameters are constrained to be;  The default is 3 indicating the range (-3,3)</p></td>
    </tr>
    <tr>
      <th>loadSymengine</th>
      <td><p>Boolean indicating if the model should be
loaded into symengine.  This cause all the ODEs to be collapsed
into one expression that is eventually optimized if
<code>optExpression</code> is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments to control SAEM.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List of options to be used in <code><a href='nlmixr.html'>nlmixr</a></code> fit for
    SAEM.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Wenping Wang &amp; Matthew L. Fidler</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Matthew Fidler, Yuan Xiong, Rik Schoemaker, Justin Wilkins, Wenping Wang, Mason McComb, Richard Hooijmaijers.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


