<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>nlmixr fits population PK and PKPD non-linear mixed effects models. — nlmixr • nlmixr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="nlmixr fits population PK and PKPD non-linear mixed effects models. — nlmixr"><meta property="og:description" content="nlmixr is an R package for fitting population pharmacokinetic (PK)
and pharmacokinetic-pharmacodynamic (PKPD) models."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nlmixr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li class="dropdown-header">Getting started</li>
    <li>
      <a href="../articles/running_nlmixr.html">Introduction to Running Nlmixr</a>
    </li>
    <li>
      <a href="../articles/multiple-endpoints.html">Using Multiple Endpoints in Nlmixr</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Going further</li>
    <li>
      <a href="../articles/modelPiping.html">Model Piping</a>
    </li>
    <li>
      <a href="../articles/broom.html">Sweeping models to tidy datasets (broom)</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/xgxr-nlmixr-ggpmx.html">Integrated development with xgxr/nlmixr/ggPMX</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-chalkboard-teacher"></span>
     
    Example models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/addingCovariances.html">Phenobarbatol with correlations</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/nimo.html">Nonlinear PK/PD -- Nimotuzumab</a>
    </li>
    <li>
      <a href="../articles/mavoglurant.html">PBPK -- Mavoglurant</a>
    </li>
    <li>
      <a href="../articles/wbc.html">PKPD -- Myelosuppression model</a>
    </li>
  </ul></li>
<li>
  <a href="https://github.com/nlmixrdevelopment/nlmixr/raw/master/CheatSheet_nlmixr.pdf" class="external-link">
    <span class="fa fa-scroll fa-lg"></span>
     
    Cheat Sheet
  </a>
</li>
<li>
  <a href="https://doi.org/10.1002/psp4.12445" class="external-link">
    <span class="fas fa-life-ring"></span>
     
    Tutorial
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o fa-lg"></span>
     
    Functions
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/nlmixrdevelopment/nlmixr" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/nlmixrdevelopment/nlmixr/releases" class="external-link">
    <span class="fa fa-download"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>nlmixr fits population PK and PKPD non-linear mixed effects models.</h1>
    <small class="dont-index">Source: <a href="https://github.com/nlmixrdevelopment/nlmixr/blob/HEAD/R/nlmixr.R" class="external-link"><code>R/nlmixr.R</code></a></small>
    <div class="hidden name"><code>nlmixr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>nlmixr is an R package for fitting population pharmacokinetic (PK)
and pharmacokinetic-pharmacodynamic (PKPD) models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">nlmixr</span><span class="op">(</span>
  <span class="va">object</span>,
  <span class="va">data</span>,
  est <span class="op">=</span> <span class="cn">NULL</span>,
  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  table <span class="op">=</span> <span class="fu"><a href="tableControl.html">tableControl</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">...</span>,
  save <span class="op">=</span> <span class="cn">NULL</span>,
  envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># S3 method for `function`</span>
<span class="fu">nlmixr</span><span class="op">(</span>
  <span class="va">object</span>,
  <span class="va">data</span>,
  est <span class="op">=</span> <span class="cn">NULL</span>,
  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  table <span class="op">=</span> <span class="fu"><a href="tableControl.html">tableControl</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">...</span>,
  save <span class="op">=</span> <span class="cn">NULL</span>,
  envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># S3 method for nlmixrFitCore</span>
<span class="fu">nlmixr</span><span class="op">(</span>
  <span class="va">object</span>,
  <span class="va">data</span>,
  est <span class="op">=</span> <span class="cn">NULL</span>,
  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  table <span class="op">=</span> <span class="fu"><a href="tableControl.html">tableControl</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">...</span>,
  save <span class="op">=</span> <span class="cn">NULL</span>,
  envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># S3 method for nlmixrUI</span>
<span class="fu">nlmixr</span><span class="op">(</span>
  <span class="va">object</span>,
  <span class="va">data</span>,
  est <span class="op">=</span> <span class="cn">NULL</span>,
  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">...</span>,
  save <span class="op">=</span> <span class="cn">NULL</span>,
  envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>Fitted object or function specifying the model.</p></dd>
<dt>data</dt>
<dd><p>Dataset to estimate.  Needs to be RxODE compatible (see
<a href="https://nlmixrdevelopment.github.io/RxODE/articles/RxODE-event-types.html" class="external-link">https://nlmixrdevelopment.github.io/RxODE/articles/RxODE-event-types.html</a>
for detailed dataset requirements).</p></dd>
<dt>est</dt>
<dd><p>Estimation method</p></dd>
<dt>control</dt>
<dd><p>Estimation control options.  They could be
<code><a href="https://rdrr.io/pkg/nlme/man/nlmeControl.html" class="external-link">nlmeControl</a></code>, <code><a href="saemControl.html">saemControl</a></code> or
<code><a href="foceiControl.html">foceiControl</a></code></p></dd>
<dt>table</dt>
<dd><p>A list controlling the table options (i.e. CWRES, NPDE etc).
See <code><a href="tableControl.html">tableControl</a></code>.</p></dd>
<dt>...</dt>
<dd><p>Other parameters</p></dd>
<dt>save</dt>
<dd><p>Boolean to save a nlmixr object in a rds file in the
working directory.  If <code>NULL</code>, uses option "nlmixr.save"</p></dd>
<dt>envir</dt>
<dd><p>Environment that nlmixr is evaluated in.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Either a nlmixr model or a nlmixr fit object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The nlmixr generalized function allows common access to the nlmixr
estimation routines.</p>
    </div>
    <div id="nlmixr-modeling-mini-language">
    <h2>nlmixr modeling mini-language</h2>
    


<p><b>Rationale</b></p>
<p>nlmixr estimation routines each have their own way of specifying
models.  Often the models are specified in ways that are most
intuitive for one estimation routine, but do not make sense for
another estimation routine.  Sometimes, legacy estimation
routines like <code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme</a></code> have their own syntax that
is outside of the control of the nlmixr package.</p>
<p>The unique syntax of each routine makes the routines themselves
easier to maintain and expand, and allows interfacing with
existing packages that are outside of nlmixr (like
<code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme</a></code>).  However, a model definition language
that is common between estimation methods, and an output object
that is uniform, will make it easier to switch between estimation
routines and will facilitate interfacing output with external
packages like Xpose.</p>
<p>The nlmixr mini-modeling language, attempts to address this issue
by incorporating a common language.  This language is inspired by
both R and NONMEM, since these languages are familiar to many
pharmacometricians.</p>
<p><b>Initial Estimates and boundaries for population parameters</b></p>
<p>nlmixr models are contained in a R function with two blocks:
<code>ini</code> and <code>model</code>.  This R function can be named
anything, but is not meant to be called directly from R.  In fact
if you try you will likely get an error such as <code>Error: could
not find function "ini"</code>.</p>
<p>The <code>ini</code> model block is meant to hold the initial estimates
for the model, and the boundaries of the parameters for estimation
routines that support boundaries (note nlmixr's <code><a href="saem.fit.html">saem</a></code>
and <code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme</a></code> do not currently support parameter boundaries).</p>
<p>To explain how these initial estimates are specified we will start
with an annotated example:</p>
<div class="sourceCode"><pre><code><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span> <span class="co">## Note the arguments to the function are currently</span>
                 <span class="co">## ignored by nlmixr</span>
    <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span>
        <span class="co">## Initial conditions for population parameters (sometimes</span>
        <span class="co">## called theta parameters) are defined by either `&lt;-` or '='</span>
        <span class="va">lCl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>      <span class="co">#log Cl (L/hr)</span>
        <span class="co">## Note that simple expressions that evaluate to a number are</span>
        <span class="co">## OK for defining initial conditions (like in R)</span>
        <span class="va">lVc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>  <span class="co">#log V (L)</span>
        <span class="co">## Also a comment on a parameter is captured as a parameter label</span>
        <span class="va">lKa</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co">#log Ka (1/hr)</span>
        <span class="co">## Bounds may be specified by c(lower, est, upper), like NONMEM:</span>
        <span class="co">## Residuals errors are assumed to be population parameters</span>
        <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
    <span class="co">## The model block will be discussed later</span>
    <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span><span class="op">}</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>

<p>As shown in the above examples:</p><ul><li><p>Simple parameter values are specified as a R-compatible assignment</p></li>
<li><p>Boundaries my be specified by <code>c(lower, est, upper)</code>.</p></li>
<li><p>Like NONMEM, <code>c(lower,est)</code> is equivalent to <code>c(lower,est,Inf)</code></p></li>
<li><p>Also like NONMEM, <code>c(est)</code> does not specify a lower bound, and is equivalent
  to specifying the parameter  without R's `c` function.</p></li>
<li><p>The initial estimates are specified on the variance scale, and in analogy with
     NONMEM, the square roots of the diagonal elements correspond to coefficients of
     variation when used in the exponential IIV implementation</p></li>
</ul><p>These parameters can be named almost any R compatible name.  Please note that:</p><ul><li><p>Residual error estimates should be coded as population estimates (i.e. using an
   '=' or '&lt;-' statement, not a '~').</p></li>
<li><p>Naming variables that start with "<code>_</code>" are not supported.  Note that R does not
    allow variable starting with "<code>_</code>" to be assigned without quoting them.</p></li>
<li><p>Naming variables that start with "<code>rx_</code>" or "<code>nlmixr_</code>" is not supported since
   <a href="https://nlmixrdevelopment.github.io/RxODE/reference/RxODE.html" class="external-link">RxODE</a> and nlmixr use these prefixes internally for certain estimation
   routines and calculating residuals.</p></li>
<li><p>Variable names are case sensitive, just like they are in R. "<code>CL</code>" is not the
   same as "<code>Cl</code>".</p></li>
</ul><p><b>Initial Estimates for between subject error distribution (NONMEM's  $OMEGA)</b></p>
<p>In mixture models, multivariate normal individual deviations from
the population parameters are estimated (in NONMEM these are
called <code>eta</code> parameters).  Additionally the
variance/covariance matrix of these deviations is also estimated
(in NONMEM this is the OMEGA matrix).  These also have initial
estimates.  In nlmixr these are specified by the `~` operator that
is typically used in R for "modeled by", and was chosen to
distinguish these estimates from the population and residual error
parameters.</p>
<p>Continuing the prior example, we can annotate the estimates for
the between subject error distribution</p>
<div class="sourceCode"><pre><code><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span>
        <span class="va">lCl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>      <span class="co">#log Cl (L/hr)</span>
        <span class="va">lVc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>  <span class="co">#log V (L)</span>
        <span class="va">lKa</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co">#log Ka (1/hr)</span>
        <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span>
        <span class="co">## Initial estimate for ka IIV variance</span>
        <span class="co">## Labels work for single parameters</span>
        <span class="va">eta.ka</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co"># BSV Ka</span>

        <span class="co">## For correlated parameters, you specify the names of each</span>
        <span class="co">## correlated parameter separated by a addition operator `+`</span>
        <span class="co">## and the left handed side specifies the lower triangular</span>
        <span class="co">## matrix initial of the covariance matrix.</span>
        <span class="va">eta.cl</span> <span class="op">+</span> <span class="va">eta.vc</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,
                            <span class="fl">0.005</span>, <span class="fl">0.1</span><span class="op">)</span>
        <span class="co">## Note that labels do not currently work for correlated</span>
        <span class="co">## parameters.  Also do not put comments inside the lower</span>
        <span class="co">## triangular matrix as this will currently break the model.</span>
    <span class="op">}</span><span class="op">)</span>
    <span class="co">## The model block will be discussed later</span>
    <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span><span class="op">}</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>

<p>As shown in the above examples:</p>
<ul><li><p>Simple variances are specified by the variable name  and the
   estimate separated by `~`.</p></li>
<li><p>Correlated parameters are specified by the sum of the variable
   labels and then the lower triangular matrix of the covariance is
   specified on the left handed side of the equation. This is also
   separated by `~`.</p></li>
</ul><p>Currently the model syntax does not allow comments inside the
lower triangular matrix.</p>
<p><b>Model Syntax for ODE based models (NONMEM's $PK, $PRED, $DES and $ERROR)</b></p>
<p>Once the initialization block has been defined, you can define a
model in terms of the defined variables in the <code>ini</code> block.  You can
also mix in RxODE blocks into the model.</p>
<p>The current method of defining a nlmixr model is to specify the
parameters, and then possibly the RxODE lines:</p>
<p>Continuing describing the syntax with an annotated example:</p>
<div class="sourceCode"><pre><code><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span>
        <span class="va">lCl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>      <span class="co">#log Cl (L/hr)</span>
        <span class="va">lVc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>   <span class="co">#log Vc (L)</span>
        <span class="va">lKA</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>      <span class="co">#log Ka (1/hr)</span>
        <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span>
        <span class="va">eta.Cl</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co">## BSV Cl</span>
        <span class="va">eta.Vc</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co">## BSV Vc</span>
        <span class="va">eta.KA</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co">## BSV Ka</span>
    <span class="op">}</span><span class="op">)</span>
    <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span>
        <span class="co">## First parameters are defined in terms of the initial estimates</span>
        <span class="co">## parameter names.</span>
        <span class="va">Cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lCl</span> <span class="op">+</span> <span class="va">eta.Cl</span><span class="op">)</span>
        <span class="va">Vc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lVc</span> <span class="op">+</span> <span class="va">eta.Vc</span><span class="op">)</span>
        <span class="va">KA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lKA</span> <span class="op">+</span> <span class="va">eta.KA</span><span class="op">)</span>
        <span class="co">## After the differential equations are defined</span>
        <span class="va">kel</span> <span class="op">&lt;-</span> <span class="va">Cl</span> <span class="op">/</span> <span class="va">Vc</span>;
        <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span>    <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span>;
        <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span>  <span class="op">=</span>  <span class="va">KA</span><span class="op">*</span><span class="va">depot</span><span class="op">-</span><span class="va">kel</span><span class="op">*</span><span class="va">centr</span>;
        <span class="co">## And the concentration is then calculated</span>
        <span class="va">cp</span> <span class="op">=</span> <span class="va">centr</span> <span class="op">/</span> <span class="va">Vc</span>;
        <span class="co">## Last, nlmixr is told that the plasma concentration follows</span>
        <span class="co">## a proportional error (estimated by the parameter prop.err)</span>
        <span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>

<p>A few points to note:</p>
<ul><li><p>Parameters are defined before the differential equations.  Currently
     directly defining the differential equations in terms of the population
     parameters is not supported.</p></li>
<li><p>The differential equations, parameters and error terms are in a single
     block, instead of multiple sections.</p></li>
<li><p>State names, calculated variables cannot start with either "<code>rx_</code>"
     or "<code>nlmixr_</code>" since these are used internally in some estimation routines.</p></li>
<li><p>Errors are specified using the `~`.  Currently you can use either <code>add(parameter)</code>
     for additive error,  prop(parameter) for proportional error or <code>add(parameter1) + prop(parameter2)</code>
     for additive plus proportional error.  You can also specify <code>norm(parameter)</code> for the additive error,
     since it follows a normal distribution.</p></li>
<li><p>Some routines, like <code><a href="saem.fit.html">saem</a></code> require  parameters in terms of <code>Pop.Parameter + Individual.Deviation.Parameter + Covariate*Covariate.Parameter</code>.
     The order of these parameters do not matter.  This is similar to NONMEM's mu-referencing, though
     not quite so restrictive.</p></li>
<li><p>The type of parameter in the model is determined by the initial block;  Covariates used in the
     model are missing in the <code>ini</code> block.  These variables need to be present in the modeling
     dataset for the model to run.</p></li>
</ul><p><b>Model Syntax for solved PK systems</b></p>
<p>Solved PK systems are also currently supported by nlmixr with the
`linCmt()` pseudo-function.  An annotated example of a solved
system is below:</p>
<p>##'</p><div class="sourceCode"><pre><code><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span>
        <span class="va">lCl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>      <span class="co">#log Cl (L/hr)</span>
        <span class="va">lVc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>   <span class="co">#log Vc (L)</span>
        <span class="va">lKA</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>      <span class="co">#log Ka (1/hr)</span>
        <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span>
        <span class="va">eta.Cl</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co">## BSV Cl</span>
        <span class="va">eta.Vc</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co">## BSV Vc</span>
        <span class="va">eta.KA</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co">## BSV Ka</span>
    <span class="op">}</span><span class="op">)</span>
    <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span>
        <span class="va">Cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lCl</span> <span class="op">+</span> <span class="va">eta.Cl</span><span class="op">)</span>
        <span class="va">Vc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lVc</span> <span class="op">+</span> <span class="va">eta.Vc</span><span class="op">)</span>
        <span class="va">KA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lKA</span> <span class="op">+</span> <span class="va">eta.KA</span><span class="op">)</span>
        <span class="co">## Instead of specifying the ODEs, you can use</span>
        <span class="co">## the linCmt() function to use the solved system.</span>
        <span class="co">##</span>
        <span class="co">## This function determines the type of PK solved system</span>
        <span class="co">## to use by the parameters that are defined.  In this case</span>
        <span class="co">## it knows that this is a one-compartment model with first-order</span>
        <span class="co">## absorption.</span>
        <span class="fu">linCmt</span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>

<p>A few things to keep in mind:</p>
<ul><li><p>Currently the solved systems support either oral dosing, IV dosing
     or IV infusion dosing and does not allow mixing the dosing types.</p></li>
<li><p>While RxODE allows mixing of solved systems and ODEs, this has not
     been implemented in nlmixr yet.</p></li>
<li><p>The solved systems implemented are the one, two and three compartment
      models with or without first-order absorption.  Each of the models support a
      lag time with a tlag parameter.</p></li>
<li><p>In general the linear compartment model figures out the model by the parameter names.
      nlmixr currently knows about numbered volumes, Vc/Vp, Clearances in terms of both Cl and
      Q/CLD.  Additionally nlmixr knows about elimination micro-constants (ie K12).  Mixing of
      these parameters for these models is currently not supported.</p></li>
</ul><p><b>Checking model syntax</b></p>
<p>After specifying the model syntax you can check that nlmixr is
interpreting it correctly by using the <code>nlmixr</code> function on
it.</p>
<p>Using the above function we can get:</p>
<div class="sourceCode"><pre><code>
&gt; nlmixr(f)
## 1-compartment model with first-order absorption in terms of Cl
## Initialization:
################################################################################
Fixed Effects ($theta):
    lCl     lVc     lKA
1.60000 4.49981 0.10000

Omega ($omega):
     [,1] [,2] [,3]
[1,]  0.1  0.0  0.0
[2,]  0.0  0.1  0.0
[3,]  0.0  0.0  0.1

## Model:
################################################################################
Cl &lt;- exp(lCl + eta.Cl)
Vc = exp(lVc + eta.Vc)
KA &lt;- exp(lKA + eta.KA)
## Instead of specifying the ODEs, you can use
## the linCmt() function to use the solved system.
##
## This function determines the type of PK solved system
## to use by the parameters that are defined.  In this case
## it knows that this is a one-compartment model with first-order
## absorption.
linCmt() ~ prop(prop.err)
</code></pre></div>

<p>In general this gives you information about the model (what type
of solved system/RxODE), initial estimates as well as the code for
the model block.</p>
<p><b>Using the model syntax for estimating a model</b></p>
<p>Once the model function has been created, you can use it and a
dataset to estimate the parameters for a model given a dataset.</p>
<p>This dataset has to have RxODE compatible events IDs.  Both
Monolix and NONMEM use a different dataset description.  You may
convert these datasets to RxODE-compatible datasets with the
<code><a href="nmDataConvert.html">nmDataConvert</a></code> function.  Note that steady state
doses are not supported by RxODE, and therefore not supported by
the conversion function.</p>
<p>As an example, you can use a simulated rich 1-compartment dataset.</p>
<div class="sourceCode"><pre><code><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">Oral_1CPT</span>
 <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"SS"</span><span class="op">]</span>;
 <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmDataConvert.html">nmDataConvert</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>;
</code></pre></div>

<p>Once the data has been converted to the appropriate format, you
can use the <code>nlmixr</code> function to run the appropriate code.</p>
<p>The method to estimate the model is:</p>
<div class="sourceCode"><pre><code><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nlmixr.html">nlmixr</a></span><span class="op">(</span><span class="va">model.function</span>, <span class="va">rxode.dataset</span>, est<span class="op">=</span><span class="st">"est"</span>,control<span class="op">=</span><span class="fu">estControl</span><span class="op">(</span><span class="va">options</span><span class="op">)</span><span class="op">)</span></code></pre></div>

<p>Currently <code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme</a></code> and <code><a href="saem.fit.html">saem</a></code> are implemented.  For example, to run the
above model with <code><a href="saem.fit.html">saem</a></code>, we could have the following:</p>
<div class="sourceCode"><pre><code>
&gt; f &lt;- function(){
    ini({
        lCl &lt;- 1.6      #log Cl (L/hr)
        lVc &lt;- log(90)   #log Vc (L)
        lKA &lt;- 0.1      #log Ka (1/hr)
        prop.err &lt;- c(0, 0.2, 1)
        eta.Cl ~ 0.1 ## BSV Cl
        eta.Vc ~ 0.1 ## BSV Vc
        eta.KA ~ 0.1 ## BSV Ka
    })
    model({
        ## First parameters are defined in terms of the initial estimates
        ## parameter names.
        Cl &lt;- exp(lCl + eta.Cl)
        Vc = exp(lVc + eta.Vc)
        KA &lt;- exp(lKA + eta.KA)
        ## After the differential equations are defined
        kel &lt;- Cl / Vc;
        d/dt(depot)    = -KA*depot;
        d/dt(centr)  =  KA*depot-kel*centr;
        ## And the concentration is then calculated
        cp = centr / Vc;
        ## Last, nlmixr is told that the plasma concentration follows
        ## a proportional error (estimated by the parameter prop.err)
        cp ~ prop(prop.err)
    })
}
&gt; fit.s &lt;- nlmixr(f,d,est="saem",control=saemControl(n.burn=50,n.em=100,print=50));
Compiling RxODE differential equations...done.
c:/Rtools/mingw_64/bin/g++  -I"c:/R/R-34~1.1/include" -DNDEBUG     -I"d:/Compiler/gcc-4.9.3/local330/include"  -Ic:/nlmixr/inst/include -Ic:/R/R-34~1.1/library/STANHE~1/include -Ic:/R/R-34~1.1/library/Rcpp/include -Ic:/R/R-34~1.1/library/RCPPAR~1/include -Ic:/R/R-34~1.1/library/RCPPEI~1/include -Ic:/R/R-34~1.1/library/BH/include   -O2 -Wall  -mtune=core2 -c saem3090757b4bd1x64.cpp -o saem3090757b4bd1x64.o
In file included from c:/R/R-34~1.1/library/RCPPAR~1/include/armadillo:52:0,
                 from c:/R/R-34~1.1/library/RCPPAR~1/include/RcppArmadilloForward.h:46,
                 from c:/R/R-34~1.1/library/RCPPAR~1/include/RcppArmadillo.h:31,
                 from saem3090757b4bd1x64.cpp:1:
c:/R/R-34~1.1/library/RCPPAR~1/include/armadillo_bits/compiler_setup.hpp:474:96: note: #pragma message: WARNING: use of OpenMP disabled; this compiler doesn't support OpenMP 3.0+
   #pragma message ("WARNING: use of OpenMP disabled; this compiler doesn't support OpenMP 3.0+")
                                                                                                ^
c:/Rtools/mingw_64/bin/g++ -shared -s -static-libgcc -o saem3090757b4bd1x64.dll tmp.def saem3090757b4bd1x64.o c:/nlmixr/R/rx_855815def56a50f0e7a80e48811d947c_x64.dll -Lc:/R/R-34~1.1/bin/x64 -lRblas -Lc:/R/R-34~1.1/bin/x64 -lRlapack -lgfortran -lm -lquadmath -Ld:/Compiler/gcc-4.9.3/local330/lib/x64 -Ld:/Compiler/gcc-4.9.3/local330/lib -Lc:/R/R-34~1.1/bin/x64 -lR
done.
1:    1.8174   4.6328   0.0553   0.0950   0.0950   0.0950   0.6357
50:    1.3900   4.2039   0.0001   0.0679   0.0784   0.1082   0.1992
100:    1.3894   4.2054   0.0107   0.0686   0.0777   0.1111   0.1981
150:    1.3885   4.2041   0.0089   0.0683   0.0778   0.1117   0.1980
Using sympy via SnakeCharmR
## Calculate ETA-based prediction and error derivatives:
Calculate Jacobian...................done.
Calculate sensitivities.......
done.
## Calculate d(f)/d(eta)
## ...
## done
## ...
## done
The model-based sensitivities have been calculated
Calculating Table Variables...
done
</code></pre></div>

<p>The options for <code><a href="saem.fit.html">saem</a></code> are controlled by <code><a href="saemControl.html">saemControl</a></code>.
You may wish to make sure the minimization is complete in the case
of <code><a href="saem.fit.html">saem</a></code>.  You can do that with <code><a href="traceplot.html">traceplot</a></code> which shows the
iteration history with the divided by burn-in and EM phases.  In
this case, the burn in seems reasonable; you may wish to increase
the number of iterations in the EM phase of the estimation.
Overall it is probably a semi-reasonable solution.</p>
<p><b>nlmixr output objects</b></p>
<p>In addition to unifying the modeling language sent to each of the
estimation routines, the outputs currently have a unified structure.</p>
<p>You can see the fit object by typing the object name:</p>
<div class="sourceCode"><pre><code>
&gt; fit.s
 -- nlmixr SAEM fit (ODE); OBJF calculated from FOCEi approximation -------------
      OBJF      AIC      BIC Log-likelihood Condition Number
  62337.09 62351.09 62399.01      -31168.55          82.6086

 -- Time (sec; fit.s$time): -----------------------------------------------------
           saem setup Likelihood Calculation covariance table
 elapsed 430.25 31.64                   1.19          0  3.44

 -- Parameters (fit.s$par.fixed): -----------------------------------------------
              Parameter Estimate     SE  <!-- %RSE Back-transformed(95%CI) BSV(CV%) -->
 lCl      log Cl (L/hr)     1.39 0.0240  1.73       4.01 (3.83, 4.20)    26.6<!-- % -->
 lVc         log Vc (L)     4.20 0.0256 0.608       67.0 (63.7, 70.4)    28.5<!-- % -->
 lKA      log Ka (1/hr)  0.00924 0.0323  349.      1.01 (0.947, 1.08)    34.3<!-- % -->
 prop.err      prop.err    0.198                             19.8<!-- % -->
          Shrink(SD)<!-- % -->
 lCl          0.248<!-- % -->
 lVc           1.09<!-- % -->
 lKA           4.19<!-- % -->
 prop.err      1.81<!-- % -->

   No correlations in between subject variability (BSV) matrix
   Full BSV covariance (fit.s$omega) or correlation (fit.s$omega.R; diagonals=SDs)
   Distribution stats (mean/skewness/kurtosis/p-value) available in fit.s$shrink

 -- Fit Data (object fit.s is a modified data.frame): ---------------------------
 # A tibble: 6,947 x 22
   ID     TIME    DV  PRED    RES    WRES IPRED  IRES  IWRES CPRED   CRES
 * &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 1      0.25  205.  198.   6.60  0.0741  189.  16.2  0.434  198.   6.78
 2 1      0.5   311.  349. -38.7  -0.261   330. -19.0 -0.291  349. -38.3
 3 1      0.75  389.  464. -74.5  -0.398   434. -45.2 -0.526  463. -73.9
 # ... with 6,944 more rows, and 11 more variables: CWRES &lt;dbl&gt;, eta.Cl &lt;dbl&gt;,
 #   eta.Vc &lt;dbl&gt;, eta.KA &lt;dbl&gt;, depot &lt;dbl&gt;, centr &lt;dbl&gt;, Cl &lt;dbl&gt;, Vc &lt;dbl&gt;,
</code></pre></div>


<p>This example shows what is typical printout of a nlmixr fit object.  The elements of the fit are:</p>
<ul><li><p>The type of fit (<code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme</a></code>, <code><a href="saem.fit.html">saem</a></code>, etc)</p></li>
<li><p>Metrics of goodness of fit (<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></code>, <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></code>,
   and <code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></code>).</p><ul><li><p>To align the comparison between methods, the FOCEi likelihood objective is calculated
          regardless of the method used and used for goodness of fit metrics.</p></li>
<li><p>This FOCEi likelihood has been compared to NONMEM's objective function and gives
         the same values (based on the data in Wang 2007)</p></li>
<li><p>Also note that <code><a href="saem.fit.html">saem</a></code> does not calculate an objective function,
            and the FOCEi is used as the only objective function for the fit.</p></li>
<li><p>Even though the objective functions are calculated in the same manner, caution should
         be used when comparing fits from various estimation routines.</p></li>
</ul></li>
<li><p>The next item is the timing of each of the steps of the fit.</p><ul><li><p>These can be also accessed by (<code>fit.s$time</code>).</p></li>
<li><p>As a mnemonic, the access for this item is shown in the printout.  This is true for
    almost all of the other items in the printout.</p></li>
</ul></li>
<li><p>After the timing of the fit, the parameter estimates are displayed (can be accessed by
     <code>fit.s$par.fixed</code>)</p><ul><li><p>While the items are rounded for R printing, each estimate without rounding is still accessible by the `$` syntax.
  For example, the `$Untransformed` gives the untransformed parameter values.</p></li>
<li><p>The Untransformed parameter takes log-space parameters and back-transforms them to normal parameters.  Not the CIs
        are listed on the back-transformed parameter space.</p></li>
<li><p>Proportional Errors are converted to <!-- %CV on the untransformed space --></p></li>
</ul></li>
<li><p>Omega block (accessed by <code>fit.s$omega</code>)</p></li>
<li><p>The table of fit data. Please note:</p><ul><li><p>A nlmixr fit object is actually a data frame.  Saving it as a Rdata object and then loading it
    without nlmixr will just show the data by itself.  Don't worry; the fit information has not vanished,
    you can bring it back by simply loading nlmixr, and then accessing the data.</p></li>
<li><p>Special access to fit information (like the <code>$omega</code>) needs nlmixr to extract the information.</p></li>
<li><p>If you use the <code>$</code> to access information, the order of precedence is:</p><ul><li><p>Fit data from the overall data.frame</p></li>
<li><p>Information about the parsed nlmixr model (via <code>$uif</code>)</p></li>
<li><p>Parameter history if available (via <code>$par.hist</code> and <code>$par.hist.stacked</code>)</p></li>
<li><p>Fixed effects table (via <code>$par.fixed</code>)</p></li>
<li><p>Individual differences from the typical population parameters (via <code>$eta</code>)</p></li>
<li><p>Fit information from the list of information generated during the post-hoc
     residual calculation.</p></li>
<li><p>Fit information from the environment where the post-hoc residual were calculated</p></li>
<li><p>Fit information about how the data and options interacted with the specified model
     (such as estimation options or if the solved system is for an infusion or an IV bolus).</p></li>
</ul></li>
<li><p>While the printout may displays the data as a <code>data.table</code> object or <code>tbl</code>
    object, the data is NOT any of these objects, but rather a derived data frame.</p></li>
<li><p>Since the object <em>is</em> a data.frame, you can treat it like one.</p></li>
</ul></li>
</ul><p>In addition to the above properties of the fit object, there are a
few additional that may be helpful for the modeler:</p>
<ul><li><p><code>$theta</code> gives the fixed effects parameter estimates (in NONMEM the
     <code>theta</code>s). This can also be accessed in <code><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixed.effects</a></code>
     function. Note that the residual variability is treated as a fixed effect parameter
     and is included in this list.</p></li>
<li><p><code>$eta</code> gives the random effects parameter estimates, or in NONMEM the
      <code>eta</code>s.  This can also be accessed in using the <code><a href="https://rdrr.io/pkg/nlme/man/random.effects.html" class="external-link">random.effects</a></code>
function.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Matthew L. Fidler, Rik Schoemaker</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">f_ode</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span class="r-in">    <span class="fu"><a href="ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span class="r-in">        <span class="va">lCl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>      <span class="co">#log Cl (L/hr)</span></span>
<span class="r-in">        <span class="va">lVc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">80</span><span class="op">)</span>   <span class="co">#log Vc (L)</span></span>
<span class="r-in">        <span class="va">lKA</span> <span class="op">&lt;-</span> <span class="fl">0.3</span>      <span class="co">#log Ka (1/hr)</span></span>
<span class="r-in">        <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in">        <span class="va">eta.Cl</span> <span class="op">~</span> <span class="fl">0.3</span> <span class="co">## BSV Cl</span></span>
<span class="r-in">        <span class="va">eta.Vc</span> <span class="op">~</span> <span class="fl">0.2</span> <span class="co">## BSV Vc</span></span>
<span class="r-in">        <span class="va">eta.KA</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co">## BSV Ka</span></span>
<span class="r-in">    <span class="op">}</span><span class="op">)</span></span>
<span class="r-in">    <span class="fu"><a href="model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span class="r-in">        <span class="co">## First parameters are defined in terms of the initial estimates</span></span>
<span class="r-in">        <span class="co">## parameter names.</span></span>
<span class="r-in">        <span class="va">Cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lCl</span> <span class="op">+</span> <span class="va">eta.Cl</span><span class="op">)</span></span>
<span class="r-in">        <span class="va">Vc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lVc</span> <span class="op">+</span> <span class="va">eta.Vc</span><span class="op">)</span></span>
<span class="r-in">        <span class="va">KA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lKA</span> <span class="op">+</span> <span class="va">eta.KA</span><span class="op">)</span></span>
<span class="r-in">        <span class="co">## After the differential equations are defined</span></span>
<span class="r-in">        <span class="va">kel</span> <span class="op">&lt;-</span> <span class="va">Cl</span> <span class="op">/</span> <span class="va">Vc</span>;</span>
<span class="r-in">        <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span>    <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span>;</span>
<span class="r-in">        <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span>  <span class="op">=</span>  <span class="va">KA</span><span class="op">*</span><span class="va">depot</span><span class="op">-</span><span class="va">kel</span><span class="op">*</span><span class="va">centr</span>;</span>
<span class="r-in">        <span class="co">## And the concentration is then calculated</span></span>
<span class="r-in">        <span class="va">cp</span> <span class="op">=</span> <span class="va">centr</span> <span class="op">/</span> <span class="va">Vc</span>;</span>
<span class="r-in">        <span class="co">## Last, nlmixr is told that the plasma concentration follows</span></span>
<span class="r-in">        <span class="co">## a proportional error (estimated by the parameter prop.err)</span></span>
<span class="r-in">        <span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span></span>
<span class="r-in">    <span class="op">}</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="va">f_linCmt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span class="r-in">    <span class="fu"><a href="ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span class="r-in">        <span class="va">lCl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>      <span class="co">#log Cl (L/hr)</span></span>
<span class="r-in">        <span class="va">lVc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>   <span class="co">#log Vc (L)</span></span>
<span class="r-in">        <span class="va">lKA</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>      <span class="co">#log Ka (1/hr)</span></span>
<span class="r-in">        <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in">        <span class="va">add.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span class="r-in">        <span class="va">eta.Cl</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co">## BSV Cl</span></span>
<span class="r-in">        <span class="va">eta.Vc</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co">## BSV Vc</span></span>
<span class="r-in">        <span class="va">eta.KA</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="co">## BSV Ka</span></span>
<span class="r-in">    <span class="op">}</span><span class="op">)</span></span>
<span class="r-in">    <span class="fu"><a href="model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span class="r-in">        <span class="va">Cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lCl</span> <span class="op">+</span> <span class="va">eta.Cl</span><span class="op">)</span></span>
<span class="r-in">        <span class="va">Vc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lVc</span> <span class="op">+</span> <span class="va">eta.Vc</span><span class="op">)</span></span>
<span class="r-in">        <span class="va">KA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lKA</span> <span class="op">+</span> <span class="va">eta.KA</span><span class="op">)</span></span>
<span class="r-in">        <span class="co">## Instead of specifying the ODEs, you can use</span></span>
<span class="r-in">        <span class="co">## the linCmt() function to use the solved system.</span></span>
<span class="r-in">        <span class="co">##</span></span>
<span class="r-in">        <span class="co">## This function determines the type of PK solved system</span></span>
<span class="r-in">        <span class="co">## to use by the parameters that are defined.  In this case</span></span>
<span class="r-in">        <span class="co">## it knows that this is a one-compartment model with first-order</span></span>
<span class="r-in">        <span class="co">## absorption.</span></span>
<span class="r-in">        <span class="fu">linCmt</span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">add.err</span><span class="op">)</span> <span class="op">+</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span></span>
<span class="r-in">    <span class="op">}</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use nlme algorithm</span></span>
<span class="r-in"><span class="va">fit_linCmt_nlme</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">nlmixr</span><span class="op">(</span><span class="va">f_ode</span>, <span class="va">Oral_1CPT</span>, est<span class="op">=</span><span class="st">"nlme"</span>,</span>
<span class="r-in">               control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/nlmeControl.html" class="external-link">nlmeControl</a></span><span class="op">(</span>maxstepsOde <span class="op">=</span> <span class="fl">50000</span>, pnlsTol<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> parameter labels from comments will be replaced by 'label()'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **Iteration 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LME step: Loglik: -40817.93, nlminb iterations: 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reStruct  parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ID1        ID2        ID3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.1221898 -0.1682207 -0.3301838 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Beginning PNLS step: ..  completed fit_nlme() step.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PNLS step: RSS =  640.6597 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fixed effects: 1.385724  4.204827  0.02666615  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  iterations: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence crit. (must all become &lt;= tolerance = 1e-05):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fixed  reStruct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  10.25022 102.28910 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **Iteration 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LME step: Loglik: -37497.72, nlminb iterations: 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reStruct  parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ID1        ID2        ID3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.2767254 -0.3391281 -0.4783564 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Beginning PNLS step: ..  completed fit_nlme() step.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PNLS step: RSS =  269.6296 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fixed effects: 1.388601  4.201673  -0.006723139  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  iterations: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence crit. (must all become &lt;= tolerance = 1e-05):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fixed reStruct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.966324 1.571577 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **Iteration 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LME step: Loglik: -37492.25, nlminb iterations: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reStruct  parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ID1        ID2        ID3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.2680315 -0.3305057 -0.4791520 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Beginning PNLS step: ..  completed fit_nlme() step.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PNLS step: RSS =  274.0337 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fixed effects: 1.388601  4.201673  -0.006723139  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  iterations: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence crit. (must all become &lt;= tolerance = 1e-05):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      fixed   reStruct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.00000000 0.03338791 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **Iteration 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LME step: Loglik: -37492.25, nlminb iterations: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reStruct  parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ID1        ID2        ID3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.2680392 -0.3305202 -0.4791585 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Beginning PNLS step: ..  completed fit_nlme() step.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PNLS step: RSS =  274.0337 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fixed effects: 1.388601  4.201673  -0.006723139  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  iterations: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence crit. (must all become &lt;= tolerance = 1e-05):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fixed reStruct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0        0 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → creating full model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → pruning branches (`if`/`else`)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → loading into <span style="color: #0000BB;">symengine</span> environment...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → creating full model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → pruning branches (`if`/`else`)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → loading into <span style="color: #0000BB;">symengine</span> environment...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → calculate jacobian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → calculate sensitivities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → calculate ∂(f)/∂(η)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → calculate ∂(R²)/∂(η)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → finding duplicate expressions in inner model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → optimizing duplicate expressions in inner model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → finding duplicate expressions in EBE model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → optimizing duplicate expressions in EBE model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → compiling inner model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → finding duplicate expressions in FD model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → optimizing duplicate expressions in FD model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → compiling EBE model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → compiling events FD model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating residuals/tables</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">fit_linCmt_nlme</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_linCmt_nlme</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span> <span style="color: #BBBB00; font-weight: bold;">nlme</span> by <span style="color: #BBBB00; font-weight: bold;">maximum likelihood</span> (<span style="font-style: italic;">ODE; μ-ref &amp; covs</span>) fit ───────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           OBJF      AIC      BIC Log-likelihood Condition Number</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FOCEi 62237.06 75018.79 75066.72      -37502.40         1.727187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nlme  62216.76 74998.49 75046.42      -37492.25         1.727187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Time</span> (sec <span style="color: #0000BB; font-weight: bold;">$time</span>): ───────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           nlme    setup table cwres    other</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elapsed 41.728 4.473892 1.164  5.81 0.721108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Population Parameters</span> (<span style="color: #0000BB; font-weight: bold;">$parFixed</span> or <span style="color: #0000BB; font-weight: bold;">$parFixedDf</span>): ───────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              <span style="font-weight: bold;">Parameter</span>     <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span> <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lCl</span>      log Cl (L/hr)     1.39 0.0238 1.72        4.01 (3.83, 4.2)     26.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lVc</span>         log Vc (L)      4.2 0.0256 0.61       66.8 (63.5, 70.2)     28.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lKA</span>      log Ka (1/hr) -0.00672 0.0313  466     0.993 (0.934, 1.06)     32.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">prop.err</span>                  0.198                               0.198         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lCl</span>         0.0750% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lVc</span>          0.932% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lKA</span>           7.35% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">prop.err</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">nlme</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Fixed parameter correlations in <span style="color: #0000BB; font-weight: bold;">$cor</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   No correlations in between subject variability (BSV) matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Fit Data</span> (object is a modified <span style="color: #0000BB;">tibble</span>): ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6,960 × 24</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ID     EVID  TIME    DV  PRED    RES   WRES IPRED  IRES  IWRES CPRED   CRES</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1         0  0.25  205.  196.   8.82  0.102  185.  19.8  0.541  196.   8.89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1         0  0.5   311.  346. -<span style="color: #BB0000;">35.3</span>  -<span style="color: #BB0000;">0.245</span>  321. -<span style="color: #BB0000;">10.6</span> -<span style="color: #BB0000;">0.166</span>  346. -<span style="color: #BB0000;">35.2</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1         0  0.75  389.  460. -<span style="color: #BB0000;">70.9</span>  -<span style="color: #BB0000;">0.388</span>  421. -<span style="color: #BB0000;">31.7</span> -<span style="color: #BB0000;">0.380</span>  460. -<span style="color: #BB0000;">70.5</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 6,957 more rows, and 12 more variables: CWRES &lt;dbl&gt;, eta.Cl &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   eta.Vc &lt;dbl&gt;, eta.KA &lt;dbl&gt;, depot &lt;dbl&gt;, centr &lt;dbl&gt;, Cl &lt;dbl&gt;, Vc &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   KA &lt;dbl&gt;, kel &lt;dbl&gt;, tad &lt;dbl&gt;, dosenum &lt;dbl&gt;</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use Focei algorithm</span></span>
<span class="r-in"><span class="va">fit_linCmt_focei</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">nlmixr</span><span class="op">(</span><span class="va">f_linCmt</span>, <span class="va">Oral_1CPT</span>, est<span class="op">=</span><span class="st">"focei"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> parameter labels from comments will be replaced by 'label()'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → creating full model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → pruning branches (`if`/`else`)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → loading into <span style="color: #0000BB;">symengine</span> environment...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → creating full model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → pruning branches (`if`/`else`)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → loading into <span style="color: #0000BB;">symengine</span> environment...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → calculate jacobian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → calculate ∂(f)/∂(η)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → calculate ∂(R²)/∂(η)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → finding duplicate expressions in inner model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → optimizing duplicate expressions in inner model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → finding duplicate expressions in EBE model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → optimizing duplicate expressions in EBE model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → compiling inner model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → finding duplicate expressions in FD model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → optimizing duplicate expressions in FD model...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → compiling EBE model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → compiling events FD model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Key:</span> U: Unscaled Parameters; X: Back-transformed parameters; G: Gill difference gradient approximation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F: Forward difference gradient approximation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C: Central difference gradient approximation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M: Mixed forward and central difference gradient approximation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unscaled parameters for Omegas=chol(solve(omega));</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Diagonals are transformed, as specified by foceiControl(diagXform=)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-----+---------------+-----------+-----------+-----------+-----------|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    #| Objective Fun |       lCl |       lVc |       lKA |  prop.err |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   add.err |        o1 |        o2 |        o3 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">    1</span>|     62378.086 |   -0.2917 |     1.000 |   -0.9599 |   -0.9154 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|    -1.000 |   -0.2123 |   -0.2123 |   -0.2123 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62378.086 |     1.600 |     4.500 |    0.1000 |    0.2000 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.778 |     1.778 |     1.778 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62378.086</span> |     4.953 |     90.00 |     1.105 |    0.2000 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.778 |     1.778 |     1.778 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    G|    Gill Diff. |     487.4 |     681.2 |     187.2 |     70.06 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.5594 |     46.70 |     288.5 |     69.87 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">    2</span>|     62504.532 |   -0.8261 |    0.2531 |    -1.165 |   -0.9922 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9994 |   -0.2635 |   -0.5286 |   -0.2889 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62504.532 |     1.066 |     3.753 |   -0.1053 |    0.1923 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.687 |     1.216 |     1.642 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62504.532</span> |     2.903 |     42.65 |    0.9001 |    0.1923 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.687 |     1.216 |     1.642 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">    3</span>|     62250.138 |   -0.5264 |    0.6720 |    -1.050 |   -0.9491 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9997 |   -0.2348 |   -0.3512 |   -0.2460 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62250.138 |     1.365 |     4.172 |  0.009862 |    0.1966 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.738 |     1.531 |     1.718 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62250.138</span> |     3.917 |     64.83 |     1.010 |    0.1966 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.738 |     1.531 |     1.718 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    F| Forward Diff. |    -51.16 |    -40.52 |     27.63 |    -82.65 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.6161 |    -181.1 |    -306.6 |    -11.29 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">    4</span>|     62272.286 |   -0.5342 |    0.6210 |    -1.114 |   -0.8526 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9988 | -0.007246 |  0.002245 |   -0.2419 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62272.286 |     1.358 |     4.121 |  -0.05440 |    0.2063 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     2.143 |     2.160 |     1.726 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62272.286</span> |     3.887 |     61.61 |    0.9470 |    0.2063 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     2.143 |     2.160 |     1.726 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">    5</span>|     62209.348 |   -0.5000 |    0.6929 |    -1.064 |   -0.9064 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9994 |   -0.1413 |   -0.1929 |   -0.2401 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62209.348 |     1.392 |     4.193 | -0.004409 |    0.2009 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.905 |     1.813 |     1.729 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62209.348</span> |     4.022 |     66.21 |    0.9956 |    0.2009 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.905 |     1.813 |     1.729 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    F| Forward Diff. |     4.259 |    -27.99 |     2.216 |     176.2 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.5135 |    -47.31 |    -69.76 |    -4.942 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">    6</span>|     62278.664 |   -0.5041 |    0.7202 |    -1.066 |    -1.078 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9989 |  -0.09516 |   -0.1249 |   -0.2353 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62278.664 |     1.388 |     4.220 | -0.006568 |    0.1837 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     1.987 |     1.934 |     1.737 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62278.664</span> |     4.005 |     68.04 |    0.9935 |    0.1837 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     1.987 |     1.934 |     1.737 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">    7</span>|     62205.639 |   -0.5007 |    0.6978 |    -1.065 |   -0.9368 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9993 |   -0.1331 |   -0.1808 |   -0.2393 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62205.639 |     1.391 |     4.198 | -0.004791 |    0.1979 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.919 |     1.834 |     1.730 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62205.639</span> |     4.019 |     66.53 |    0.9952 |    0.1979 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.919 |     1.834 |     1.730 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    F| Forward Diff. |     5.482 |    -13.33 |     1.146 |    -8.050 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.5783 |    -34.90 |    -51.22 |    -2.300 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">    8</span>|     62204.377 |   -0.5036 |    0.7048 |    -1.065 |   -0.9325 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9990 |   -0.1146 |   -0.1537 |   -0.2381 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62204.377 |     1.388 |     4.205 | -0.005399 |    0.1983 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.952 |     1.883 |     1.733 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62204.377</span> |     4.007 |     67.00 |    0.9946 |    0.1983 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01000 |     1.952 |     1.883 |     1.733 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    F| Forward Diff. |    -5.005 |     6.076 |   0.02355 |     17.86 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.5667 |    -6.648 |    -8.466 |   -0.6091 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">    9</span>|     62205.622 |   -0.4836 |    0.6824 |    -1.063 |   -0.9374 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9972 |   -0.1046 |   -0.1427 |   -0.2368 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62205.622 |     1.408 |     4.182 | -0.002890 |    0.1978 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     1.970 |     1.902 |     1.735 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62205.622</span> |     4.088 |     65.51 |    0.9971 |    0.1978 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     1.970 |     1.902 |     1.735 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">   10</span>|     62204.331 |   -0.5025 |    0.7036 |    -1.065 |   -0.9363 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9989 |   -0.1132 |   -0.1518 |   -0.2379 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62204.331 |     1.389 |     4.203 | -0.005404 |    0.1979 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     1.955 |     1.886 |     1.733 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62204.331</span> |     4.012 |     66.91 |    0.9946 |    0.1979 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     1.955 |     1.886 |     1.733 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    F| Forward Diff. |   -0.7833 |     2.682 |   0.08084 |    -6.082 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.5753 |    -4.469 |    -5.489 |   -0.1852 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">   11</span>|     62204.314 |   -0.5020 |    0.7021 |    -1.065 |   -0.9334 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9986 |   -0.1110 |   -0.1492 |   -0.2378 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62204.314 |     1.390 |     4.202 | -0.005419 |    0.1982 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     1.958 |     1.891 |     1.733 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62204.314</span> |     4.014 |     66.81 |    0.9946 |    0.1982 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     1.958 |     1.891 |     1.733 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    F| Forward Diff. |    0.6437 |    -1.884 |    0.2261 |     12.41 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.5679 |    -1.207 |    -1.444 |   -0.1867 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">   12</span>|     62204.318 |   -0.5039 |    0.7017 |    -1.066 |   -0.9356 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9953 |   -0.1092 |   -0.1499 |   -0.2378 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62204.318 |     1.388 |     4.202 | -0.005695 |    0.1980 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01002 |     1.962 |     1.889 |     1.733 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62204.318</span> |     4.006 |     66.79 |    0.9943 |    0.1980 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01002 |     1.962 |     1.889 |     1.733 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |<span style="font-weight: bold;">   13</span>|     62204.314 |   -0.5020 |    0.7021 |    -1.065 |   -0.9334 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   -0.9986 |   -0.1110 |   -0.1492 |   -0.2378 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    U|     62204.314 |     1.390 |     4.202 | -0.005419 |    0.1982 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     1.958 |     1.891 |     1.733 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |    X|<span style="font-weight: bold;">     62204.314</span> |     4.014 |     66.81 |    0.9946 |    0.1982 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |.....................|   0.01001 |     1.958 |     1.891 |     1.733 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> calculating covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating residuals/tables</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>gradient problems with initial estimate and covariance; see $scaleInfo</span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">fit_linCmt_focei</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_linCmt_focei</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span> <span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) fit ────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           OBJF      AIC      BIC Log-likelihood Condition Number</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FOCEi 62204.31 74988.05 75042.81      -37486.02         1.826486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Time</span> (sec <span style="color: #0000BB; font-weight: bold;">$time</span>): ───────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            setup optimize covariance table    other</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elapsed 5.212046 6.688262   6.688269 0.798 7.979423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Population Parameters</span> (<span style="color: #0000BB; font-weight: bold;">$parFixed</span> or <span style="color: #0000BB; font-weight: bold;">$parFixedDf</span>): ───────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              <span style="font-weight: bold;">Parameter</span>     <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span>  <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lCl</span>      log Cl (L/hr)     1.39 0.0242  1.74       4.01 (3.83, 4.21)     26.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lVc</span>         log Vc (L)      4.2 0.0258 0.615       66.8 (63.5, 70.3)     28.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lKA</span>      log Ka (1/hr) -0.00542 0.0327   603     0.995 (0.933, 1.06)     34.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">prop.err</span>                  0.198                                0.198         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">add.err</span>                    0.01                                 0.01         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lCl</span>          0.396% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lVc</span>           1.42% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lKA</span>           6.27% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">prop.err</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">add.err</span>             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r,s</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Fixed parameter correlations in <span style="color: #0000BB; font-weight: bold;">$cor</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   No correlations in between subject variability (BSV) matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     relative convergence (4) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Fit Data</span> (object is a modified <span style="color: #0000BB;">tibble</span>): ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6,960 × 21</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ID     EVID  TIME    DV  PRED    RES    WRES IPRED  IRES  IWRES CPRED   CRES</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1         0  0.25  205.  196.   8.64  0.098<span style="text-decoration: underline;">0</span>  184.  20.6  0.566  196.   8.86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1         0  0.5   311.  346. -<span style="color: #BB0000;">35.6</span>  -<span style="color: #BB0000;">0.242</span>   321. -<span style="color: #BB0000;">10.2</span> -<span style="color: #BB0000;">0.161</span>  346. -<span style="color: #BB0000;">35.1</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1         0  0.75  389.  460. -<span style="color: #BB0000;">71.1</span>  -<span style="color: #BB0000;">0.382</span>   422. -<span style="color: #BB0000;">32.4</span> -<span style="color: #BB0000;">0.387</span>  460. -<span style="color: #BB0000;">70.3</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 6,957 more rows, and 9 more variables: CWRES &lt;dbl&gt;, eta.Cl &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   eta.Vc &lt;dbl&gt;, eta.KA &lt;dbl&gt;, Cl &lt;dbl&gt;, Vc &lt;dbl&gt;, KA &lt;dbl&gt;, tad &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   dosenum &lt;dbl&gt;</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The ODE model can be fitted using the saem algorithm, more</span></span>
<span class="r-in"><span class="co"># iterations should be used for real applications</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">fit_ode_saem</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">nlmixr</span><span class="op">(</span><span class="va">f_ode</span>, <span class="va">Oral_1CPT</span>, est <span class="op">=</span> <span class="st">"saem"</span>,</span>
<span class="r-in">        control <span class="op">=</span> <span class="fu"><a href="saemControl.html">saemControl</a></span><span class="op">(</span>n.burn <span class="op">=</span> <span class="fl">50</span>, n.em <span class="op">=</span> <span class="fl">100</span>, print <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> parameter labels from comments will be replaced by 'label()'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → generate SAEM model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:    1.8298   4.6775   0.1602   0.2850   0.1900   0.0950   0.6393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50:    1.3912   4.2090   0.0133   0.0695   0.0794   0.1075   0.1982</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100:    1.3877   4.2020   0.0017   0.0681   0.0790   0.1126   0.1978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150:    1.3877   4.2022   0.0023   0.0680   0.0787   0.1124   0.1978</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → creating full model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → pruning branches (`if`/`else`)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → loading into <span style="color: #0000BB;">symengine</span> environment...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → compiling EBE model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating residuals/tables</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">fit_ode_saem</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_ode_saem</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span> <span style="color: #BBBB00; font-weight: bold;">SAEM</span>(<span style="font-style: italic;">ODE</span>); <span style="font-weight: 100; font-style: italic;">OBJF not calculated</span> fit ───────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Gaussian/Laplacian Likelihoods: AIC() or <span style="color: #0000BB; font-weight: bold;">$objf</span> etc. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  FOCEi CWRES &amp; Likelihoods: addCwres() </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Time</span> (sec <span style="color: #0000BB; font-weight: bold;">$time</span>): ───────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            saem    setup table covariance    other</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elapsed 339.898 1.667443 0.284      0.768 1.001557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Population Parameters</span> (<span style="color: #0000BB; font-weight: bold;">$parFixed</span> or <span style="color: #0000BB; font-weight: bold;">$parFixedDf</span>): ───────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              <span style="font-weight: bold;">Parameter</span>   <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span>     <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lCl</span>      log Cl (L/hr)   1.39  0.024     1.73        4.01 (3.82, 4.2)     26.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lVc</span>         log Vc (L)    4.2  0.026    0.619       66.8 (63.5, 70.3)     28.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lKA</span>      log Ka (1/hr) 0.0023 0.0325 1.41e+03          1 (0.94, 1.07)     34.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">prop.err</span>                0.198                                   0.198         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lCl</span>         <span style="color: #BB0000; font-weight: bold;">-0.393%</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lVc</span>           1.29% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">lKA</span>           4.36% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">prop.err</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">linFim</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Fixed parameter correlations in <span style="color: #0000BB; font-weight: bold;">$cor</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   No correlations in between subject variability (BSV) matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Fit Data</span> (object is a modified <span style="color: #0000BB;">tibble</span>): ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6,960 × 21</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ID     EVID  TIME    DV  PRED    RES IPRED   IRES   IWRES eta.Cl eta.Vc eta.KA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1         0  0.25  205.  197.   7.36  173.  31.5   0.919  0.086<span style="text-decoration: underline;">2</span>  0.141 0.012<span style="text-decoration: underline;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1         0  0.5   311.  348. -<span style="color: #BB0000;">37.6</span>   305.   5.25  0.087<span style="text-decoration: underline;">0</span> 0.086<span style="text-decoration: underline;">2</span>  0.141 0.012<span style="text-decoration: underline;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1         0  0.75  389.  463. -<span style="color: #BB0000;">73.4</span>   405. -<span style="color: #BB0000;">16.2</span>  -<span style="color: #BB0000;">0.202</span>  0.086<span style="text-decoration: underline;">2</span>  0.141 0.012<span style="text-decoration: underline;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 6,957 more rows, and 9 more variables: cp &lt;dbl&gt;, depot &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   centr &lt;dbl&gt;, Cl &lt;dbl&gt;, Vc &lt;dbl&gt;, KA &lt;dbl&gt;, kel &lt;dbl&gt;, tad &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   dosenum &lt;dbl&gt;</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Matthew Fidler, Yuan Xiong, Rik Schoemaker, Justin Wilkins, Wenping Wang, Mason McComb, Vipul Mann, Richard Hooijmaijers.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

